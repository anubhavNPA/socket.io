<!doctype html>
<html>
<head>
    <title>Eyehawk.io</title>
</head>
<body>

<div class="header">
    <h2>Eyehawk.io - Anonymous Chat</h2>
</div>

<div class="chats">
    <div class="select_chat">
        <div class="time">
            <a href='/?room=1'>
                Chat Time: 6:30pm Pacific Time
                <div class="join"><i class="fa fa-comment" aria-hidden="true"></i> Join Chat</div>
            </a>
        </div>
        <div class="host">Host: Sam</div>
        <div class="host">Desc: Mid Level PHP Engineer</div>
        <div class="host">Location: San Francisco</div>
        <div class="skill">PHP</div>
        <div class="skill">Laravel</div>
        <div class="skill">ElasticSearch</div>
    </div>
    <div class="select_chat blue">
        <div class="time">
            <a href='/?room=2'>
                Chat Time: 6:30pm Pacific Time
                <div class="join"><i class="fa fa-comment" aria-hidden="true"></i> Join Chat</div>
            </a>
        </div>
        <div class="host">Host: Alex</div>
        <div class="host">Desc: Python Dev</div>
        <div class="host">Location: San Francisco</div>
        <div class="skill">Python</div>
        <div class="skill">Django</div>
        <div class="skill">Flask</div>
    </div>
    <div class="select_chat">
        <div class="time">
            <a href='/?room=3'>
                Chat Time: 6:30pm Pacific Time
                <div class="join"><i class="fa fa-comment" aria-hidden="true"></i> Join Chat</div>
            </a>
        </div>
        <div class="host">Host: Maddy</div>
        <div class="host">Desc: Senior Rails Developer</div>
        <div class="host">Location: San Francisco</div>
        <div class="skill">Ruby on Rails</div>
        <div class="skill">Redis</div>
        <div class="skill">Sidekiq</div>
    </div>
    <div class="select_chat blue">
        <div class="time">
            <a href='/?room=4'>
                Chat Time: 6:30pm Pacific Time
                <div class="join"><i class="fa fa-comment" aria-hidden="true"></i> Join Chat</div>
            </a>
        </div>
        <div class="host">Host: Taylor</div>
        <div class="host">Desc: Senior Java Engineer</div>
        <div class="host">Location: San Francisco</div>
        <div class="skill">Java</div>
        <div class="skill">Spring</div>
        <div class="skill">J2EE</div>
    </div>
    <div class="select_chat">
        <div class="time">
            <a href='/?room=5'>
                Chat Time: 6:30pm Pacific Time
                <div class="join"><i class="fa fa-comment" aria-hidden="true"></i> Join Chat</div>
            </a>
        </div>
        <div class="host">Host: Eric</div>
        <div class="host">Desc: Node Engineer</div>
        <div class="host">Location: San Francisco</div>
        <div class="skill">Node JS</div>
        <div class="skill">MongoDB</div>
        <div class="skill">Nginx</div>
    </div>
    <div class="select_chat blue">
        <div class="time">
            <a href='/?room=6'>
                Chat Time: 6:30pm Pacific Time
                <div class="join"><i class="fa fa-comment" aria-hidden="true"></i> Join Chat</div>
            </a>
        </div>
        <div class="host">Host: Sarah</div>
        <div class="host">Desc: Frontend Engineer</div>
        <div class="host">Location: San Francisco</div>
        <div class="skill">Angular JS</div>
        <div class="skill">Bootstrap</div>
        <div class="skill">React JS</div>
    </div>
    <div class="select_chat">
        <div class="time">
            <a href='/?room=7'>
                Chat Time: 6:30pm Pacific Time
                <div class="join"><i class="fa fa-comment" aria-hidden="true"></i> Join Chat</div>
            </a>
        </div>
        <div class="host">Host: Sam, JobSpringPartners</div>
        <div class="host">Desc: Junior DevOps</div>
        <div class="host">Location: San Francisco</div>
        <div class="skill">AWS</div>
        <div class="skill">Chef</div>
        <div class="skill">Docker</div>
    </div>
    <div class="select_chat blue">
        <div class="time">
            <a href='/?room=8'>
                Chat Time: 6:30pm Pacific Time
                <div class="join"><i class="fa fa-comment" aria-hidden="true"></i> Join Chat</div>
            </a>
        </div>
        <div class="host">Host: Tim</div>
        <div class="host">Desc: Senior QA</div>
        <div class="host">Location: San Francisco</div>
        <div class="skill">Jenkins</div>
        <div class="skill">Selenium</div>
        <div class="skill">VMWare</div>
    </div>
</div>

<div class="column-center">
    <div id="chatdiv">
        <div id="messages"></div>
    </div>
</div>


<div class="column-right">
    <div class="challenges">
        <h3>Required Skills & Experience</h3>
        <p>Object Oriented PHP development (LAMP stack)</p>
        <p>Codeigniter, Laravel, or similar (Phalcon, Zend, Yii, etc.)</p>
        <p>SQL, MySQL, Postres</p>

        <h3>Desired Skills & Experience</h3>
        <p>Computer Science experience</p>
        <p>ElasticSearch</p>
        <p>Exposure to big data technology</p>
        <p>Exposure to data science technology</p>

        <h3>Benefits & Perks</h3>
        <p>One day work-from-home</p>
        <p>Potential to become a Lead or Manager</p>
        <p>Competitive salary</p>
        <p>Full health and dental insurance</p>
        <p>Profit sharing</p>
        <p>Stock options</p>
        <p>Paid vacation</p>
    </div>
    <div class="resume">
        <p>Upload for Matching</p>
        <p><input type="file" name="resume" size="chars"></p>
        <input type="submit" value="Analyze Resume">
        <p>***Resume Kept Private***</p>
    </div>
</div>


<form action="">
    <input id="msg_input" autocomplete="off" /><button>Send</button>
</form>

<script src="/socket.io/socket.io.js"></script>
<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
<script src="https://use.fontawesome.com/2c93e0255c.js"></script>
<link rel="stylesheet" type="text/css" href="css/style.css" />

<video autoplay></video>

<script>
    /*
    function hasGetUserMedia() {
        return !!(navigator.getUserMedia || navigator.webkitGetUserMedia ||
        navigator.mozGetUserMedia || navigator.msGetUserMedia);
    }


    if (hasGetUserMedia()) {
        // Good to go!
        console.log('audio available');
        navigator.getUserMedia  = navigator.getUserMedia ||
                navigator.webkitGetUserMedia ||
                navigator.mozGetUserMedia ||
                navigator.msGetUserMedia;
    } else {
        console.log('getUserMedia() is not supported in your browser');
    }


    var errorCallback = function(e) {
        console.log('Reeeejected!', e);
    };

    function initializeRecorder(stream) {
        var audioContext = window.AudioContext;
        var context = new audioContext();
        var audioInput = context.createMediaStreamSource(stream);
        var bufferSize = 2048;
        // create a javascript node
        var recorder = context.createJavaScriptNode(bufferSize, 1, 1);
        // specify the processing function
        recorder.onaudioprocess = recorderProcess;
        // connect stream to our recorder
        audioInput.connect(recorder);
        // connect our recorder to the previous destination
        recorder.connect(context.destination);
    }

    function recorderProcess(e) {
        var left = e.inputBuffer.getChannelData(0);
    }

    var video = document.querySelector('video');

    if (navigator.getUserMedia) {
        navigator.getUserMedia({audio: true, video: true}, function(stream) {
            video.src = window.URL.createObjectURL(stream);
        }, errorCallback);
    } else {
        video.src = 'somevideo.webm'; // fallback.
    }
    */
</script>

<script>

    function auto_scroll() {
        var elem = document.getElementById('messages');
        elem.scrollTop = elem.scrollHeight;
    }

    function getSearchParameters(key) {
        var prmstr = window.location.search.substr(1);
        arr = prmstr != null && prmstr != "" ? transformToAssocArray(prmstr) : {};
        return arr[key] || '';
    }

    function transformToAssocArray( prmstr ) {
        var params = {};
        var prmarr = prmstr.split("&");
        for ( var i = 0; i < prmarr.length; i++) {
            var tmparr = prmarr[i].split("=");
            params[tmparr[0]] = tmparr[1];
        }
        return params;
    }

    var socket = io();

    // join room
    socket.emit('subscribe', getSearchParameters('room'));
    socket.emit('send', { room: getSearchParameters('room'), message: getSearchParameters('handle') + ' : entered room' });

    $('form').submit(function() {

        var msg = getSearchParameters('handle') + ': ' + $('#msg_input').val();
        socket.emit('send', { room: getSearchParameters('room'), message: msg });

        $('#msg_input').val('');
        return false;
    });

    socket.on('message', function (msg) {
        $('#messages').append($('<li>').text(msg));
        auto_scroll();
    });

</script>
</body>
</html>